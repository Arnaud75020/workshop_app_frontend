{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\arbog\\\\Documents\\\\workshop_app_frontend\\\\front-end\\\\src\\\\Components\\\\SharedComponents\\\\Login.js\";\nimport React, { useContext, useState } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { UserContext } from '../../Context/UserContext';\nimport { WorkshopContext } from '../../Context/WorkshopContext';\nimport { Link } from \"react-router-dom\";\nimport './Login.scss';\nimport axios from 'axios';\nimport { AuthContext } from '../../Context/AuthContext';\n\nconst Login = () => {\n  const {\n    register,\n    handleSubmit,\n    reset,\n    errors\n  } = useForm();\n  const {\n    setUserInformation\n  } = useContext(UserContext);\n  const {\n    userWorkshops,\n    getUserWorkshops,\n    getWorkshop,\n    getAttendees\n  } = useContext(WorkshopContext);\n  const {\n    setAuth\n  } = useContext(AuthContext);\n  const [incorrectEmail, setIncorrectEmail] = useState(false);\n  const [incorrectPassword, setIncorrectPassword] = useState(false);\n\n  const onSubmit = async data => {\n    //run validation\n    axios.post('/auth/login', data).then(response => response.data).then(user => {\n      setUserInformation(user);\n      const {\n        id,\n        role\n      } = user.user;\n\n      if (role === 'attendee') {\n        getUserWorkshops(user.id);\n      }\n\n      if (role === \"speaker\") {\n        getWorkshop(id);\n        getAttendees(id);\n      }\n    }).then(() => setAuth(true)).catch(error => {\n      if (error.response.data.message === 'Incorrect email.') {\n        setIncorrectEmail(true);\n\n        if (incorrectPassword === true) {\n          setIncorrectPassword(false);\n        } //console.log(error.response.data);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n\n      } else if (error.response.data.message === 'Incorrect password.') {\n        setIncorrectPassword(true);\n\n        if (incorrectEmail === true) {\n          setIncorrectEmail(false);\n        } //console.log(error.request);\n\n      }\n    }); //const response = await axios.post('/auth/login', data);\n    //console.log(\"response\",response)\n    //await setUserInformation(response.data);\n    //const { id, role } = response.data.user\n    //if(role === \"attendee\"){\n    //  getUserWorkshops(id)\n    //}\n    //if(role === \"speaker\"){\n    //    getWorkshop(id);\n    //    getAttendees(id)\n    //}\n    //setAuth(true);\n    ////redirect to role-based view\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-page-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-img\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"right-side-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 11\n    }\n  }, \"Welcome to productized\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit(onSubmit),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    name: \"email\",\n    type: \"text\",\n    placeholder: \"Email Address\",\n    ref: register,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }\n  }), incorrectEmail && /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }\n  }, \"no user found with this email\"), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"password\",\n    type: \"password\",\n    placeholder: \"Password\",\n    ref: register,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }\n  }), incorrectPassword && /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }, \"incorrect password\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }, \"Login\"), /*#__PURE__*/React.createElement(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  }, \"don't have an account yet? \", /*#__PURE__*/React.createElement(Link, {\n    to: \"/signup\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 41\n    }\n  }, \"create an account\")), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 11\n    }\n  }, \"Forgot your account?\"))));\n};\n\nexport default Login;","map":{"version":3,"sources":["C:/Users/arbog/Documents/workshop_app_frontend/front-end/src/Components/SharedComponents/Login.js"],"names":["React","useContext","useState","useForm","UserContext","WorkshopContext","Link","axios","AuthContext","Login","register","handleSubmit","reset","errors","setUserInformation","userWorkshops","getUserWorkshops","getWorkshop","getAttendees","setAuth","incorrectEmail","setIncorrectEmail","incorrectPassword","setIncorrectPassword","onSubmit","data","post","then","response","user","id","role","catch","error","message"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport { UserContext } from '../../Context/UserContext';\r\nimport { WorkshopContext } from '../../Context/WorkshopContext';\r\nimport { Link } from \"react-router-dom\";\r\nimport './Login.scss';\r\nimport axios from 'axios';\r\nimport { AuthContext } from '../../Context/AuthContext';\r\n\r\nconst Login = () => {\r\n  const { register, handleSubmit, reset, errors } = useForm();\r\n  const { setUserInformation } = useContext(UserContext);\r\n  const { userWorkshops, getUserWorkshops, getWorkshop, getAttendees } = useContext(WorkshopContext);\r\n  const { setAuth } = useContext(AuthContext);\r\n\r\n  const [incorrectEmail, setIncorrectEmail] = useState(false)\r\n  const [incorrectPassword, setIncorrectPassword] = useState(false)\r\n\r\n  const onSubmit = async (data) => {\r\n    //run validation\r\n      axios\r\n           .post('/auth/login', data)\r\n           .then((response) => response.data)\r\n           .then((user) => {\r\n            setUserInformation(user);\r\n            const { id, role } = user.user\r\n             if (role === 'attendee') {\r\n               getUserWorkshops(user.id);\r\n             }\r\n             if(role === \"speaker\"){\r\n                  getWorkshop(id);\r\n                  getAttendees(id)\r\n              }\r\n           })\r\n           .then(() => setAuth(true))\r\n           .catch((error) => {\r\n            if (error.response.data.message === 'Incorrect email.') {\r\n              setIncorrectEmail(true)\r\n              if(incorrectPassword === true){\r\n                setIncorrectPassword(false)\r\n              }\r\n              //console.log(error.response.data);\r\n              //console.log(error.response.status);\r\n              //console.log(error.response.headers);\r\n            } else if (error.response.data.message === 'Incorrect password.') {\r\n              setIncorrectPassword(true)\r\n              if(incorrectEmail === true){\r\n                setIncorrectEmail(false)\r\n              }\r\n              //console.log(error.request);\r\n            } \r\n           })\r\n    //const response = await axios.post('/auth/login', data);\r\n    //console.log(\"response\",response)\r\n    //await setUserInformation(response.data);\r\n    //const { id, role } = response.data.user\r\n    //if(role === \"attendee\"){\r\n    //  getUserWorkshops(id)\r\n    //}\r\n    //if(role === \"speaker\"){\r\n    //    getWorkshop(id);\r\n    //    getAttendees(id)\r\n    //}\r\n    //setAuth(true);\r\n    ////redirect to role-based view\r\n  };\r\n\r\n  return (\r\n    <div className='login-page-container'>\r\n      <div className='login-container'>\r\n        <div className='login-img' />\r\n        <div className='right-side-container'>\r\n          <h1>Welcome to productized</h1>\r\n          <form onSubmit={handleSubmit(onSubmit)}>\r\n            <input\r\n              name='email'\r\n              type='text'\r\n              placeholder='Email Address'\r\n              ref={register}\r\n            />\r\n            {incorrectEmail && \r\n            <p>no user found with this email</p>\r\n            }\r\n            <input\r\n              name='password'\r\n              type='password'\r\n              placeholder='Password'\r\n              ref={register}\r\n            />\r\n            {incorrectPassword && \r\n            <p>incorrect password</p>\r\n            }\r\n            <button type='submit'>Login</button>\r\n            <hr />\r\n          </form>\r\n          <p>don't have an account yet? <Link to=\"/signup\">create an account</Link></p>\r\n          <p>Forgot your account?</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}